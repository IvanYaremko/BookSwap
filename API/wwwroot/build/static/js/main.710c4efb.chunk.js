(this["webpackJsonpclient-app"]=this["webpackJsonpclient-app"]||[]).push([[0],{390:function(e,t,n){},391:function(e,t,n){"use strict";n.r(t),n.d(t,"history",(function(){return We}));var r=n(53),o=n.n(r),a=n(30),i=(n(261),n(262),n(0)),c=n(405),s=n(14),u=n(21),l=n(240),d=n(98),j=n(242),b=n(409),p=n(7),h=n.n(p),f=n(12),O=n(8),x=n(11),m=n(56),g=n.n(m),v=function(e){return new Promise((function(t){setTimeout(t,e)}))};g.a.interceptors.response.use(function(){var e=Object(f.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(500);case 2:return e.abrupt("return",t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),g.a.defaults.baseURL="/api",g.a.interceptors.request.use((function(e){var t=T.commonStore.token;return t&&(e.headers.Authorization="Bearer ".concat(t)),e}));var w=function(e){return e.data},k=function(e){return g.a.get(e).then(w)},y=function(e,t){return g.a.post(e,t).then(w)},S=function(e,t,n){return g.a.put(e,t).then(w)},C=function(e){return g.a.delete(e).then(w)},M={Books:{list:function(){return k("/books")},listOwned:function(e){return k("/books/".concat(e,"/owned"))},details:function(e){return k("/books/".concat(e))},create:function(e){return y("/books",e)},update:function(e){return S("/books/".concat(e.id),e)},delete:function(e){return C("/books/".concat(e))}},Account:{current:function(){return k("/account")},login:function(e){return y("/account/login",e)},register:function(e){return y("/account/register",e)},getUserById:function(e){return k("/account/".concat(e))}},Swaps:{list:function(){return k("/swap")},listRequested:function(e){return k("/swap/".concat(e,"/rm"))},listMyRequests:function(e){return k("/swap/".concat(e,"/ir"))},listHistory:function(e){return k("/swap/".concat(e,"/history"))},details:function(e){return k("/swap/".concat(e))},create:function(e){return y("/swap",e)},update:function(e,t){return S("/swap/".concat(e),t)},delete:function(e){return C("/swap/".concat(e))}},Profiles:{get:function(e){return k("/profiles/".concat(e))},uploadPhoto:function(e){var t=new FormData;return t.append("File",e),g.a.post("photos",t,{headers:{"Content-type":"multipart/form-data"}})},setMainPhoto:function(e){return y("/photos/".concat(e,"/setMain"),{})},deletePhoto:function(e){return C("/photos/".concat(e))},updateProfile:function(e){return S("/profiles",e)}}},I=g.a.create({baseURL:"https://api2.isbndb.com/book",headers:{Authorization:"46761_da8695639d322094f5fe34bf7c7b8dae"}});I.interceptors.response.use(function(){var e=Object(f.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){if(404===e.response.status)We.push("/not-found")}));var L=function(e){return e.data},A={requests:{get:function(e){return I.get(e).then(L)}}},B=n(411),q=n(5),P=n(15),R=n(10),N=function(){function e(){var t=this;Object(O.a)(this,e),this.profile=null,this.loadingProfile=!1,this.isUploading=!1,this.isMainLoading=!1,this.loading=!1,this.loadProfile=function(){var e=Object(f.a)(h.a.mark((function e(n){var r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loadingProfile=!0,e.prev=1,e.next=4,M.Profiles.get(n);case 4:r=e.sent,Object(x.h)((function(){t.profile=r,t.loadingProfile=!1})),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0),Object(x.h)((function(){return t.loadingProfile=!1}));case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),this.uploadPhoto=function(){var e=Object(f.a)(h.a.mark((function e(n){var r,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isUploading=!0,e.prev=1,e.next=4,M.Profiles.uploadPhoto(n);case 4:r=e.sent,o=r.data,Object(x.h)((function(){var e;t.profile&&(null===(e=t.profile.photos)||void 0===e||e.push(o),o.isMain&&T.userStore.user&&(T.userStore.setImage(o.url),t.profile.image=o.url));t.isUploading=!1})),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0),Object(x.h)((function(){return t.isUploading=!1}));case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),this.setMain=function(){var e=Object(f.a)(h.a.mark((function e(n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isMainLoading=!0,e.prev=1,e.next=4,M.Profiles.setMainPhoto(n.id);case 4:T.userStore.setImage(n.url),Object(x.h)((function(){t.profile&&t.profile.photos&&(t.profile.photos.find((function(e){return e.isMain})).isMain=!1,t.profile.photos.find((function(e){return e.id===n.id})).isMain=!0,t.profile.image=n.url,t.isMainLoading=!1)})),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0),Object(x.h)((function(){return t.isMainLoading=!1}));case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),this.deletePhoto=function(){var e=Object(f.a)(h.a.mark((function e(n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isMainLoading=!0,e.prev=1,e.next=4,M.Profiles.deletePhoto(n.id);case 4:Object(x.h)((function(){var e;t.profile&&(t.profile.photos=null===(e=t.profile.photos)||void 0===e?void 0:e.filter((function(e){return e.id!==n.id})),t.isMainLoading=!1)})),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0),Object(x.h)((function(){return t.isMainLoading=!1}));case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),this.updateProfile=function(){var e=Object(f.a)(h.a.mark((function e(n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,e.next=4,M.Profiles.updateProfile(n);case 4:Object(x.h)((function(){var e;n.displayName&&n.displayName!==(null===(e=T.userStore.user)||void 0===e?void 0:e.displayName)&&T.userStore.setDisplayName(n),t.profile=Object(P.a)(Object(P.a)({},t.profile),n),t.loading=!1})),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0),Object(x.h)((function(){return t.loading=!1}));case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),Object(x.d)(this)}return Object(R.a)(e,[{key:"isCurrentUser",get:function(){return!(!T.userStore.user||!this.profile)&&T.userStore.user.userName===this.profile.userName}}]),e}(),D=function(){function e(){var t=this;Object(O.a)(this,e),this.swapMap=new Map,this.selectedSwap=void 0,this.requestedMap=new Map,this.requestDetails=void 0,this.myRequestsMap=new Map,this.historyMap=new Map,this.selectedRequestor=void 0,this.sumbittedSwap=void 0,this.editSwap=!1,this.loading=!1,this.loadingInitial=!1,this.loadRequested=function(){var e=Object(f.a)(h.a.mark((function e(n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,e.next=4,M.Swaps.listRequested(n);case 4:e.sent.forEach((function(e){t.requestedMap.set(e.swapId,e)})),Object(x.h)((function(){return t.loading=!1})),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0),Object(x.h)((function(){return t.loading=!1}));case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),this.loadMyRequests=function(){var e=Object(f.a)(h.a.mark((function e(n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loadingInitial=!0,e.prev=1,e.next=4,M.Swaps.listMyRequests(n);case 4:e.sent.forEach((function(e){t.myRequestsMap.set(e.swapId,e)})),Object(x.h)((function(){return t.loading=!1})),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0),Object(x.h)((function(){return t.loading=!1}));case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),this.loadHistory=function(){var e=Object(f.a)(h.a.mark((function e(n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,e.next=4,M.Swaps.listHistory(n);case 4:e.sent.forEach((function(e){t.historyMap.set(e.swapId,e)})),Object(x.h)((function(){return t.loading=!1})),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0),Object(x.h)((function(){return t.loading=!1}));case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),this.loadSwaps=Object(f.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.setLoadingInitial(!0),e.prev=1,e.next=4,M.Swaps.list();case 4:e.sent.forEach((function(e){t.setSwap(e)})),Object(x.h)((function(){return t.setLoadingInitial(!1)})),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0),Object(x.h)((function(){return t.setLoadingInitial(!1)}));case 13:case"end":return e.stop()}}),e,null,[[1,9]])}))),this.loadRequest=function(e){return t.requestedMap.get(e)},this.loadSwap=function(){var e=Object(f.a)(h.a.mark((function e(n){var r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=t.getSwap(n))){e.next=6;break}return t.selectedSwap=r,e.abrupt("return",r);case 6:return t.setLoadingInitial(!0),e.prev=7,e.next=10,M.Swaps.details(n);case 10:return r=e.sent,t.setSwap(r),Object(x.h)((function(){t.selectedSwap=r})),t.setLoadingInitial(!1),e.abrupt("return",r);case 17:e.prev=17,e.t0=e.catch(7),console.log(e.t0),t.setLoadingInitial(!1);case 21:case"end":return e.stop()}}),e,null,[[7,17]])})));return function(t){return e.apply(this,arguments)}}(),this.createSwap=function(){var e=Object(f.a)(h.a.mark((function e(n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,e.next=4,M.Swaps.create(n);case 4:Object(x.h)((function(){t.swapMap.set(n.id,n),t.selectedSwap=n,t.editSwap=!1,t.loading=!1})),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0),Object(x.h)((function(){t.loading=!1}));case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),this.updateSwap=function(){var e=Object(f.a)(h.a.mark((function e(n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,e.next=4,M.Swaps.update(n.id,n);case 4:Object(x.h)((function(){t.swapMap.set(n.id,n),t.selectedSwap=n,t.editSwap=!1,t.loading=!1})),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0),Object(x.h)((function(){t.loading=!1}));case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),this.deleteSwap=function(){var e=Object(f.a)(h.a.mark((function e(n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,e.next=4,M.Swaps.delete(n);case 4:Object(x.h)((function(){t.swapMap.delete(n),t.myRequestsMap.delete(n),t.requestedMap.delete(n),t.loading=!1})),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0),Object(x.h)((function(){t.loading=!1}));case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),this.clearSelectedSwap=function(){t.selectedSwap=void 0},this.setLoadingInitial=function(e){t.loadingInitial=e},this.setSwap=function(e){t.swapMap.set(e.id,e)},this.getSwap=function(e){return t.swapMap.get(e)},Object(x.d)(this)}return Object(R.a)(e,[{key:"setRequestDetails",value:function(e){this.requestDetails=e}}]),e}(),E=function(){function e(){var t=this;Object(O.a)(this,e),this.user=null,this.getUser=Object(f.a)(h.a.mark((function e(){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.user){e.next=2;break}return e.abrupt("return",t.user);case 2:return e.prev=2,e.next=5,M.Account.current();case 5:n=e.sent,Object(x.h)((function(){return t.user=n})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[2,9]])}))),this.getUserById=function(){var e=Object(f.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M.Account.getUserById(t);case 3:return n=e.sent,e.abrupt("return",n);case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),this.login=function(){var e=Object(f.a)(h.a.mark((function e(n){var r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M.Account.login(n);case 3:r=e.sent,T.commonStore.setToken(r.token),Object(x.h)((function(){return t.user=r})),We.push("/books"),e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(0),console.log(e.t0),e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),this.logout=function(){T.commonStore.setToken(null),window.localStorage.removeItem("jwt"),t.user=null,We.push("/")},this.register=function(){var e=Object(f.a)(h.a.mark((function e(n){var r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M.Account.register(n);case 3:r=e.sent,T.commonStore.setToken(r.token),Object(x.h)((function(){return t.user=r})),We.push("/books"),e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),this.setImage=function(e){t.user&&(t.user.image=e)},this.setDisplayName=function(e){t.user&&(t.user.displayName=e.displayName)},Object(x.d)(this)}return Object(R.a)(e,[{key:"checkLogin",get:function(){return!!this.user}}]),e}(),T={bookStore:new function e(){var t=this;Object(O.a)(this,e),this.bookMap=new Map,this.booksOwnedMap=new Map,this.selectedBook=void 0,this.submittingBook=void 0,this.editMode=!1,this.loading=!1,this.loadingInitial=!1,this.county=void 0,this.loadBooks=Object(f.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.setLoadingInitial(!0),e.prev=1,e.next=4,M.Books.list();case 4:e.sent.forEach((function(e){t.setBook(e)})),t.setLoadingInitial(!1),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0),t.setLoadingInitial(!1);case 13:case"end":return e.stop()}}),e,null,[[1,9]])}))),this.loadBook=function(){var e=Object(f.a)(h.a.mark((function e(n){var r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=t.getBook(n))){e.next=6;break}return t.selectedBook=r,e.abrupt("return",r);case 6:return t.setLoadingInitial(!0),e.prev=7,e.next=10,M.Books.details(n);case 10:return r=e.sent,Object(x.h)((function(){t.selectedBook=r})),t.setLoadingInitial(!1),e.abrupt("return",r);case 16:e.prev=16,e.t0=e.catch(7),console.log(e.t0),t.setLoadingInitial(!1);case 20:case"end":return e.stop()}}),e,null,[[7,16]])})));return function(t){return e.apply(this,arguments)}}(),this.loadOwnedBooks=function(){var e=Object(f.a)(h.a.mark((function e(n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,e.next=4,M.Books.listOwned(n);case 4:e.sent.forEach((function(e){t.booksOwnedMap.set(e.id,e)})),Object(x.h)((function(){t.loading=!1})),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0),Object(x.h)((function(){return t.loading=!1}));case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),this.setBook=function(e){t.bookMap.set(e.id,e)},this.getBook=function(e){return t.bookMap.get(e)},this.setLoadingInitial=function(e){t.loadingInitial=e},this.createBook=function(){var e=Object(f.a)(h.a.mark((function e(n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,e.next=4,M.Books.create(n);case 4:Object(x.h)((function(){t.bookMap.set(n.id,n),t.selectedBook=n,t.editMode=!1,t.loading=!1})),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0),Object(x.h)((function(){t.loading=!1}));case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),this.updateBook=function(){var e=Object(f.a)(h.a.mark((function e(n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,e.next=4,M.Books.update(n);case 4:Object(x.h)((function(){t.bookMap.set(n.id,n),t.selectedBook=n,t.editMode=!1,t.loading=!1})),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0),Object(x.h)((function(){t.loading=!1}));case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),this.deleteBook=function(){var e=Object(f.a)(h.a.mark((function e(n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,e.next=4,M.Books.delete(n);case 4:Object(x.h)((function(){t.bookMap.delete(n),t.booksOwnedMap.delete(n),t.loading=!1})),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0),Object(x.h)((function(){t.loading=!1}));case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),this.setSubmittingBook=function(){var e=Object(f.a)(h.a.mark((function e(n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,e.next=4,A.requests.get(n).then((function(e){var n=e.book,r={id:"",title:n.title,author:n.authors[0],synopsys:n.synopsys,pages:n.pages,binding:n.binding,isbn13:n.isbn13,image:n.image,county:"carlow",isMarket:!0,appUserId:T.userStore.user.id};Object(x.h)((function(){t.submittingBook=r,t.loading=!1}))}));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),Object(x.h)((function(){t.loading=!1}));case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}(),this.setCounty=function(e){t.county=e},Object(x.d)(this)},commonStore:new function e(){var t=this;Object(O.a)(this,e),this.error=null,this.token=window.localStorage.getItem("jwt"),this.applicationLoaded=!1,this.setServerError=function(e){t.error=e},this.setToken=function(e){t.token=e},this.setApplicationLoaded=function(e){t.applicationLoaded=e},Object(x.d)(this),Object(x.g)((function(){return t.token}),(function(e){e?window.localStorage.setItem("jwt",e):window.localStorage.removeItem("jwt")}))},userStore:new E,swapStore:new D,profileStore:new N,messageStore:new function e(){var t=this;Object(O.a)(this,e),this.messages=[],this.hubConnection=null,this.createHubConnection=function(e){T.swapStore.selectedSwap&&(t.hubConnection=(new B.a).withUrl(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_MESSAGES:"/message",REACT_APP_API_URL:"/api"}).REACT_APP_API_MESSAGES_URL+"?swapId="+e,{accessTokenFactory:function(){var e;return null===(e=T.userStore.user)||void 0===e?void 0:e.token},skipNegotiation:!0}).withAutomaticReconnect().configureLogging(q.a.Information).build(),t.hubConnection.start().then((function(){return console.log("connection started")})).catch((function(e){return console.log("error starting hub ",e)})),t.hubConnection.on("LoadMessages",(function(e){Object(x.h)((function(){e.forEach((function(e){e.createdAt=new Date(e.createdAt+"Z")})),t.messages=e}))})),t.hubConnection.on("ReceiveMessage",(function(e){Object(x.h)((function(){e.createdAt=new Date(e.createdAt),t.messages.unshift(e)}))})))},this.stopHubConnection=function(){var e;null===(e=t.hubConnection)||void 0===e||e.stop().catch((function(e){return console.log("Error stopping hub",e)}))},this.removeMessages=function(){t.messages=[],t.stopHubConnection()},this.addMessage=function(){var e=Object(f.a)(h.a.mark((function e(n){var r,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.swapId=null===(r=T.swapStore.selectedSwap)||void 0===r?void 0:r.id,e.prev=1,e.next=4,null===(o=t.hubConnection)||void 0===o?void 0:o.invoke("SendMessage",n);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}(),Object(x.d)(this)}},F=Object(i.createContext)(T);function z(){return Object(i.useContext)(F)}var U=n(1),G=Object(s.a)((function(){var e=z().userStore,t=e.user,n=e.logout;return Object(U.jsx)(l.a,{inverted:!0,fixed:"top",children:Object(U.jsxs)(c.a,{children:[Object(U.jsx)(l.a.Item,{as:u.b,to:"/",exact:!0,header:!0,children:Object(U.jsx)(d.a,{name:"book",size:"large"})}),Object(U.jsx)(l.a.Item,{as:u.b,to:"/books",name:"Market"}),Object(U.jsx)(l.a.Item,{name:"My Swaps",as:u.b,to:"/swaps"}),Object(U.jsx)(l.a.Item,{as:u.b,to:"/createBook",positive:!0,content:"Add book"}),Object(U.jsx)(l.a.Item,{as:u.b,to:"/history",positive:!0,content:"History"}),Object(U.jsx)(l.a.Item,{as:u.b,to:"/profile/".concat(null===t||void 0===t?void 0:t.userName),positive:!0,content:"Profile"}),Object(U.jsxs)(l.a.Item,{position:"right",children:[(null===t||void 0===t?void 0:t.image)?Object(U.jsx)(j.a,{src:null===t||void 0===t?void 0:t.image,avatar:!0}):Object(U.jsx)(d.a,{name:"user"}),Object(U.jsx)(b.a,{text:null===t||void 0===t?void 0:t.userName,children:Object(U.jsx)(b.a.Menu,{children:Object(U.jsx)(b.a.Item,{onClick:n,text:"logout",icon:"power"})})})]})]})})})),H=n(193),_=n(419),K=n(392),W=Object(s.a)((function(){var e=z().userStore;return Object(U.jsx)(H.a,{textAlign:"center",vertical:!0,className:"home",style:{marginTop:"250px"},children:Object(U.jsxs)(c.a,{text:!0,children:[Object(U.jsx)(_.a,{as:"h1",content:"BookSwap"}),e.checkLogin?Object(U.jsx)(U.Fragment,{children:Object(U.jsx)(K.a,{as:u.a,to:"/books",size:"medium",children:"Go to BookSwap"})}):Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)(K.a,{size:"medium",as:u.a,to:"/login",positive:!0,children:"Login"}),Object(U.jsx)(K.a,{size:"medium",as:u.a,to:"/register",positive:!0,children:"Register"})]})]})})})),V=n(17),J=n(416),Z=n(406);function Q(e){var t=e.inverted,n=void 0===t||t,r=e.content,o=void 0===r?"loading...":r;return Object(U.jsx)(J.a,{active:!0,inverted:n,children:Object(U.jsx)(Z.a,{content:o})})}var X=n(417),Y=n(31),$=n(38),ee=n(412),te=n(142);function ne(e){var t=Object(Y.d)(e.name),n=Object(V.a)(t,2),r=n[0],o=n[1];return Object(U.jsxs)(ee.a.Field,{error:o.touched&&!!o.error,children:[Object(U.jsx)("label",{children:e.label}),Object(U.jsx)("input",Object(P.a)(Object(P.a)({},r),e)),o.touched&&o.error?Object(U.jsx)(te.a,{basic:!0,color:"red",children:o.error}):null]})}function re(e){var t=Object(Y.d)(e.name),n=Object(V.a)(t,2),r=n[0],o=n[1];return Object(U.jsxs)(ee.a.Field,{error:o.touched&&!!o.error,children:[Object(U.jsx)("label",{children:e.label}),Object(U.jsx)("textarea",Object(P.a)(Object(P.a)({},r),e)),o.touched&&o.error?Object(U.jsx)(te.a,{basic:!0,color:"red",children:o.error}):null]})}var oe=Object(s.a)((function(){var e=Object(a.g)(),t=z(),n=t.bookStore,r=t.userStore.user,o=n.createBook,c=n.updateBook,s=n.loading,l=n.loadBook,d=n.loadingInitial,b=n.submittingBook,p=Object(a.i)().id,h=Object(i.useState)({id:"",title:"",author:"",synopsys:"n/a",pages:0,binding:"n/a",isbn13:"",image:"",county:r.county,isMarket:!0,appUserId:""}),f=Object(V.a)(h,2),O=f[0],x=f[1],m=$.b({title:$.c().required(),author:$.c().required(),synopsys:$.c().required(),pages:$.a().required(),binding:$.c().required(),isbn13:$.c().required()});return Object(i.useEffect)((function(){p?l(p).then((function(e){return x(e)})):x(Object(P.a)({},b))}),[p,l,b]),d||s?Object(U.jsx)(Q,{content:"Loading book..."}):Object(U.jsxs)(H.a,{clearing:!0,children:[Object(U.jsx)(_.a,{content:"Book Details",sub:!0,color:"teal"}),Object(U.jsx)(Y.c,{enableReinitialize:!0,initialValues:O,onSubmit:function(t){return function(t){if(0===t.id.length){var n=Object(P.a)(Object(P.a)({},t),{},{id:Object(X.a)(),appUserId:r.id});o(n).then((function(){return e.push("/books")}))}else c(t).then((function(){return e.push("/books")}))}(t)},validationSchema:m,children:function(e){var t=e.handleSubmit,n=e.isValid,o=e.isSubmitting;e.dirty;return Object(U.jsxs)(Y.b,{className:"ui form",onSubmit:t,autoComplete:"off",children:[Object(U.jsx)(j.a,{centered:!0,src:O.image,size:"small",rounded:!0,placeholder:"Image",name:"image"}),Object(U.jsx)(ne,{name:"title",placeholder:"Title"}),Object(U.jsx)(ne,{placeholder:"Author",name:"author"}),Object(U.jsx)(re,{rows:3,placeholder:"Synopsys",name:"synopsys"}),Object(U.jsx)(ne,{placeholder:"Pages",name:"pages"}),Object(U.jsx)(ne,{placeholder:"Binding",name:"binding"}),Object(U.jsx)(ne,{placeholder:"isbn13",name:"isbn13"}),Object(U.jsx)(K.a,{disabled:o||!n,loading:s,floated:"right",positive:!0,type:"submit",content:"submit"}),Object(U.jsx)(K.a,{as:u.a,to:"/profile/".concat(null===r||void 0===r?void 0:r.id),floated:"right",type:"button",content:"cancel"})]})}})]})})),ae=n(415),ie=Object(s.a)((function(){var e=Object(a.g)(),t=z(),n=t.bookStore,r=t.userStore,o=t.swapStore,c=n.selectedBook,s=n.loadBook,l=n.loadingInitial,d=r.user,b=o.createSwap,p=o.swapMap,h=Object(a.i)().id;return Object(i.useEffect)((function(){h&&s(h)}),[h,s]),l||!c?Object(U.jsx)(Q,{}):Object(U.jsxs)(ae.a,{fluid:!0,children:[Object(U.jsx)(j.a,{src:c.image,size:"small",centered:!0}),Object(U.jsxs)(ae.a.Content,{children:[Object(U.jsx)(ae.a.Header,{children:c.title}),Object(U.jsx)(ae.a.Meta,{children:Object(U.jsx)("span",{className:"date",children:c.binding})}),Object(U.jsx)(ae.a.Description,{children:Object(U.jsx)("h4",{children:c.author})}),Object(U.jsx)(ae.a.Description,{children:c.synopsys})]}),Object(U.jsxs)(ae.a.Content,{extra:!0,children:[console.log(p.get("dcd0e50c-2c73-44dd-ba33-a3a406dbf5e1")),console.log(Array.from(p.values()).filter((function(e){return e.ownerBookID===c.id&&e.requesterID===(null===d||void 0===d?void 0:d.id)})).length),Array.from(p.values()).filter((function(e){return e.ownerBookID===c.id&&e.requesterID===(null===d||void 0===d?void 0:d.id)})).length>=1?Object(U.jsx)(K.a.Group,{widths:"2",children:Object(U.jsx)(K.a,{size:"tiny",as:u.a,to:"/books",color:"red",content:"Already requested"})}):Object(U.jsx)(K.a.Group,{widths:"2",children:Object(U.jsx)(K.a,{size:"tiny",as:u.a,to:"/books",color:"green",content:"Request swap",onClick:function(){var t={id:Object(X.a)(),ownerID:c.appUserId,ownerBookID:c.id,requesterID:d.id,requesterBookID:"",status:"request"};console.log(t),b(t).then((function(){return e.push("/books")}))}})})]})]})})),ce=n(237);function se(){return Object(U.jsxs)(H.a,{placeholder:!0,children:[Object(U.jsxs)(_.a,{icon:!0,children:[Object(U.jsx)(d.a,{name:"search"}),"Could not find"]}),Object(U.jsx)(H.a.Inline,{children:Object(U.jsx)(K.a,{as:u.a,to:"/books",primary:!0,children:"return to books page"})})]})}var ue=Object(s.a)((function(){var e=Object(a.g)(),t=z().bookStore,n=t.setSubmittingBook,r=t.loading;var o=$.b().shape({isbn:$.c().required()});return Object(U.jsx)(H.a,{clearing:!0,children:Object(U.jsx)(Y.c,{enableReinitialize:!0,initialValues:{isbn:""},onSubmit:function(t){return function(t){n(t.isbn),e.push("/edit")}(t)},validationSchema:o,children:function(e){var t=e.handleSubmit,n=e.isValid,o=e.isSubmitting,a=e.dirty;e.values;return Object(U.jsxs)(ee.a,{className:"ui form",onSubmit:t,autoComplete:"off",children:[Object(U.jsx)(ne,{placeholder:"isbn",name:"isbn"}),Object(U.jsx)(K.a,{disabled:o||!n||!a,loading:r,type:"submit",positive:!0,content:"get book details"})]})}})})})),le=n(243),de=Object(s.a)((function(){var e=z().userStore;return Object(U.jsx)(le.a,{children:Object(U.jsx)(le.a.Column,{width:8,verticalAlign:"middle",style:{marginTop:"200px",marginLeft:"450px"},children:Object(U.jsx)(Y.c,{initialValues:{email:"",password:"",error:null},onSubmit:function(t){return e.login(t)},children:function(e){var t=e.handleSubmit,n=e.isSubmitting;return Object(U.jsxs)(Y.b,{className:"ui form",onSubmit:t,autoComplete:"off",children:[Object(U.jsx)(_.a,{as:"h2",content:"Login to BookSwap",color:"teal",textAlign:"center"}),Object(U.jsx)(ne,{name:"email",placeholder:"Email"}),Object(U.jsx)(ne,{name:"password",placeholder:"Password",type:"password"}),Object(U.jsx)(K.a,{loading:n,positive:!0,content:"Login",type:"submit",fluid:!0})]})}})})})})),je=n(120),be=n.n(je),pe=Object(s.a)((function(){var e=z().userStore,t=Object(i.useState)(""),n=Object(V.a)(t,2),r=n[0],o=n[1],a=["Antrim","Armagh","Carlow","Cavan","Clare","Cork","Derry","Donegal","Down","Dublin","Fermanagh","Galway","Kerry","Kildare","Kilkenny","Laois","Leitrim","Limerick","Longford","Louth","Mayo","Meath","Monaghan","Offaly","Roscommon","Sligo","Tipperary","Tyrone","Waterford","Westmeath","Wexford","Wicklow"],c=be.a.map(a,(function(e,t){return{key:a[t],text:e,value:a[t]}}));function s(e,t){o(t.value)}return Object(U.jsx)(le.a,{children:Object(U.jsx)(le.a.Column,{width:8,verticalAlign:"middle",style:{marginTop:"200px",marginLeft:"450px"},children:Object(U.jsx)(Y.c,{initialValues:{displayName:"",userName:"",bio:"",email:"",password:"",error:null},onSubmit:function(t){return(n=t).county=r,void e.register(n);var n},children:function(e){var t=e.handleSubmit,n=e.isSubmitting;return Object(U.jsxs)(Y.b,{className:"ui form error",onSubmit:t,autoComplete:"off",children:[Object(U.jsx)(_.a,{as:"h2",content:"Register to BookSwap",color:"teal",textAlign:"center"}),Object(U.jsx)(ne,{name:"displayName",placeholder:"Display Name"}),Object(U.jsx)(ne,{name:"userName",placeholder:"Username"}),Object(U.jsx)(ne,{name:"bio",placeholder:"Bio"}),Object(U.jsx)(b.a,{name:"county",placeholder:"County",search:!0,selection:!0,options:c,onChange:s}),Object(U.jsx)(ne,{name:"email",placeholder:"Email"}),Object(U.jsx)(ne,{name:"password",placeholder:"Password",type:"password"}),Object(U.jsx)(K.a,{loading:n,positive:!0,content:"Register",type:"submit",fluid:!0})]})}})})})})),he=n(414),fe=n(408),Oe=Object(s.a)((function(){var e=Object(i.useState)(),t=Object(V.a)(e,2),n=t[0],r=t[1],o=Object(i.useState)(""),a=Object(V.a)(o,2),c=a[0],s=a[1],l=z().bookStore.bookMap;return Object(U.jsx)(U.Fragment,{children:Object(U.jsx)(fe.a,{onSearchChange:function(e){var t=e.target.value;s(t);var n=Array.from(l.values()).filter((function(e){return e.title===t}));r(n)},noResultsMessage:"No book found.",resultRenderer:function(){return Object(U.jsx)(U.Fragment,{children:Object(U.jsx)(he.a.Group,{divided:!0,children:Object(U.jsxs)(he.a,{children:[Object(U.jsx)(he.a.Image,{size:"tiny",src:n[0].image,as:u.a,to:"/books/".concat(n[0].id)}),Object(U.jsxs)(he.a.Content,{verticalAlign:"middle",children:[Object(U.jsx)(he.a.Header,{as:u.a,to:"/books/".concat(n[0].id),children:n[0].title}),Object(U.jsxs)(he.a.Content,{children:[" ",n[0].author," "]})]})]})})})},results:n,value:c})})})),xe=Object(s.a)((function(){var e=z(),t=e.bookStore,n=e.userStore,r=t.bookMap,o=t.county;return Object(U.jsx)(U.Fragment,{children:Object(U.jsx)(H.a,{children:Object(U.jsx)(he.a.Group,{divided:!0,children:Array.from(r.values()).filter((function(e){var t;return e.county.toLowerCase()===(null===o||void 0===o?void 0:o.toLowerCase())&&e.appUserId!==(null===(t=n.user)||void 0===t?void 0:t.id)})).map((function(e){return Object(U.jsxs)(he.a,{children:[Object(U.jsx)(he.a.Image,{size:"tiny",src:e.image,as:u.a,to:"/books/".concat(e.id)}),Object(U.jsxs)(he.a.Content,{verticalAlign:"middle",children:[Object(U.jsx)(he.a.Header,{as:u.a,to:"/books/".concat(e.id),children:e.title}),Object(U.jsxs)(he.a.Content,{children:[" ",e.author," "]})]}),Object(U.jsx)(he.a.Meta,{hidden:!0,children:e.isbn13})]},e.id)}))})})})})),me=Object(s.a)((function(){var e=z(),t=e.bookStore,n=e.userStore,r=e.swapStore,o=t.loadBooks,a=t.bookMap,c=t.county,s=t.setCounty,u=n.user,l=r.loadSwaps,d=r.swapMap,j=["Antrim","Armagh","Carlow","Cavan","Clare","Cork","Derry","Donegal","Down","Dublin","Fermanagh","Galway","Kerry","Kildare","Kilkenny","Laois","Leitrim","Limerick","Longford","Louth","Mayo","Meath","Monaghan","Offaly","Roscommon","Sligo","Tipperary","Tyrone","Waterford","Westmeath","Wexford","Wicklow"],p=be.a.map(j,(function(e,t){return{key:j[t],text:e,value:j[t]}}));return Object(i.useEffect)((function(){o(),void 0===c&&s(null===u||void 0===u?void 0:u.county)}),[a.size,o,c,s,null===u||void 0===u?void 0:u.county,d.size,d,l]),t.loadingInitial?Object(U.jsx)(Q,{content:"Loading Books"}):Object(U.jsx)(U.Fragment,{children:Object(U.jsx)(le.a,{centered:!0,children:Object(U.jsxs)(le.a.Column,{width:"10",children:[Object(U.jsx)(le.a.Row,{children:Object(U.jsx)(Oe,{})}),Object(U.jsx)(b.a,{name:"county",placeholder:"County",search:!0,selection:!0,options:p,onChange:function(e,t){s(t.value)},defaultValue:c}),Object(U.jsx)(xe,{})]})})})})),ge=Object(s.a)((function(){var e=z().swapStore,t=e.myRequestsMap,n=e.deleteSwap;return Object(U.jsx)(U.Fragment,{children:0===t.size?Object(U.jsx)("h2",{children:"No requests made"}):Object(U.jsx)(H.a,{compact:!0,children:Object(U.jsx)(he.a.Group,{divided:!0,relaxed:!0,children:Array.from(t.values()).map((function(e){return Object(U.jsxs)(he.a,{children:[Object(U.jsx)(he.a.Image,{size:"tiny",src:e.ownerBook.image}),Object(U.jsxs)(he.a.Content,{verticalAlign:"middle",children:[Object(U.jsx)(he.a.Header,{children:e.ownerBook.title}),Object(U.jsxs)(he.a.Content,{children:[" ",e.ownerBook.author," "]})]}),Object(U.jsx)(he.a.Meta,{hidden:!0,children:e.ownerBook.isbn13}),Object(U.jsx)(K.a,{content:"cancel",size:"tiny",style:{height:"50px",width:"70px",marginTop:"75px"},color:"red",onClick:function(){return t=e.swapId,void n(t);var t}})]},e.swapId)}))})})})})),ve=Object(s.a)((function(){var e=z().swapStore.requestedMap;return Object(U.jsx)(U.Fragment,{children:0===e.size?Object(U.jsx)("h2",{children:"No swaps"}):Object(U.jsx)(H.a,{children:Object(U.jsx)(he.a.Group,{divided:!0,children:Array.from(e.values()).map((function(e){var t;return Object(U.jsxs)(he.a,{children:[Object(U.jsxs)(he.a.Content,{style:{marginLeft:"25px"},children:[0===e.requestor.photos.length?Object(U.jsx)(d.a,{name:"user",size:"big"}):Object(U.jsx)(j.a,{src:null===(t=e.requestor.photos.find((function(e){return e.isMain})))||void 0===t?void 0:t.url,size:"tiny"}),Object(U.jsx)(le.a.Column,{width:1}),Object(U.jsx)(he.a.Header,{children:e.requestor.userName}),Object(U.jsx)(le.a.Column,{width:1}),Object(U.jsxs)(he.a.Content,{children:[" ",e.requestor.county," "]})]}),Object(U.jsx)(he.a.Content,{children:Object(U.jsx)(u.a,{to:"/requestor/".concat(e.swapId),children:Object(U.jsx)(d.a,{name:"arrows alternate horizontal",size:"huge",style:{marginTop:"35px",marginLeft:"25px"}})})}),Object(U.jsx)(he.a.Content,{children:Object(U.jsx)(he.a.Image,{src:e.ownerBook.image,size:"tiny"})})]},e.swapId)}))})})})})),we=Object(s.a)((function(){var e=z(),t=e.swapStore,n=e.bookStore,r=e.userStore,o=t.loadSwaps,a=t.loadRequested,c=t.loadMyRequests,s=t.loading,u=t.loadingInitial,l=(t.myRequestsMap,t.requestedMap),d=n.loadBooks;return Object(i.useEffect)((function(){d(),o(),a(r.user.id),c(r.user.id),console.log("my requests ",l)}),[d,o,a,c,r.user]),u||s?Object(U.jsx)(Q,{content:"Loading Swaps"}):Object(U.jsx)(U.Fragment,{children:Object(U.jsxs)(le.a,{centered:!0,columns:2,children:[Object(U.jsxs)(le.a.Column,{children:[Object(U.jsx)("h1",{children:"My requests"}),Object(U.jsx)(le.a.Row,{width:1}),Object(U.jsx)(ge,{})]}),Object(U.jsxs)(le.a.Column,{children:[Object(U.jsx)("h1",{children:"Swap requests"}),Object(U.jsx)(ve,{})]})]})})})),ke=Object(s.a)((function(){var e,t=Object(a.g)(),n=z(),r=n.swapStore,o=n.bookStore,c=r.loadRequest,s=r.updateSwap,u=r.deleteSwap,l=r.loadSwap,d=r.selectedSwap,j=r.loading,b=o.deleteBook,p=Object(a.i)().id,h=Object(i.useState)(),f=Object(V.a)(h,2),O=f[0],x=f[1];return Object(i.useEffect)((function(){if(p){var e=c(p);x(e),l(p)}}),[p,c,l]),void 0===O?Object(U.jsx)(Q,{content:"Loading users books..."}):Object(U.jsxs)(U.Fragment,{children:[console.log(O),Object(U.jsxs)(le.a,{centered:!0,children:[Object(U.jsx)(le.a.Row,{children:Object(U.jsxs)("h1",{children:[O.requestor.userName," book's"]})}),Object(U.jsx)(le.a.Row,{children:Object(U.jsx)(H.a,{children:Object(U.jsx)(he.a.Group,{divided:!0,children:null===(e=O.requestor.books)||void 0===e?void 0:e.map((function(e){return Object(U.jsxs)(he.a,{children:[Object(U.jsx)(he.a.Image,{size:"tiny",src:e.image,to:"/books/".concat(e.id)}),Object(U.jsxs)(he.a.Content,{verticalAlign:"middle",children:[Object(U.jsx)(he.a.Header,{children:e.title}),Object(U.jsxs)(he.a.Content,{children:[" ",e.author," "]})]}),Object(U.jsx)(le.a.Column,{children:Object(U.jsx)(K.a,{content:"swap",style:{marginTop:"75px"},color:"blue",onClick:function(){return function(e){d.status="confirmed",d.requesterBookID=e.id;var n=null===O||void 0===O?void 0:O.ownerBook;b(null===n||void 0===n?void 0:n.id),b(e.id),s(d).then((function(){return t.push("/books")}))}(e)},loading:j})})]},e.id)}))})})}),Object(U.jsx)(K.a,{content:"Decline swap",color:"red",onClick:function(){u(p).then((function(){return t.push("/swaps")}))}})]})]})})),ye=Object(s.a)((function(){var e=z(),t=e.swapStore,n=e.userStore,r=t.historyMap;return Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)("h1",{children:"Swap History"}),Object(U.jsx)(H.a,{compact:!0,children:Object(U.jsx)(he.a.Group,{divided:!0,relaxed:!0,children:Array.from(r.values()).map((function(e){var t,r,o,a;return Object(U.jsxs)(he.a,{children:[Object(U.jsxs)(le.a.Column,{children:[Object(U.jsx)(le.a.Row,{}),Object(U.jsx)(le.a.Row,{children:Object(U.jsx)(he.a.Image,{src:e.ownerBook.image,size:"tiny"})})]}),Object(U.jsx)(le.a.Column,{children:Object(U.jsx)(u.a,{to:"/history/".concat(e.swapId),children:Object(U.jsx)(d.a,{name:"arrows alternate horizontal",style:{marginLeft:"25px",marginTop:"40px"},size:"huge"})})}),Object(U.jsxs)(le.a.Column,{style:{marginLeft:"25px"},children:[Object(U.jsx)(le.a.Row,{}),Object(U.jsx)(le.a.Row,{children:Object(U.jsx)(he.a.Image,{src:e.requestorBook.image,size:"tiny"})})]}),Object(U.jsxs)(le.a.Column,{style:{marginLeft:"25px"},children:[Object(U.jsx)(le.a.Row,{children:Object(U.jsx)(he.a.Content,{children:Object(U.jsx)("b",{children:"Member"})})}),Object(U.jsxs)(le.a.Row,{children:[Object(U.jsx)(he.a.Content,{children:e.owner.userName===(null===(t=n.user)||void 0===t?void 0:t.userName)?e.requestor.userName:e.owner.userName}),e.owner.userName===(null===(r=n.user)||void 0===r?void 0:r.userName)?Object(U.jsx)(j.a,{src:null===(o=e.requestor.photos.find((function(e){return e.isMain})))||void 0===o?void 0:o.url,size:"tiny"}):Object(U.jsx)(j.a,{src:null===(a=e.owner.photos.find((function(e){return e.isMain})))||void 0===a?void 0:a.url,size:"tiny"}),Object(U.jsx)(he.a.Content,{children:e.requestor.county})]})]})]},e.swapId)}))})})]})})),Se=Object(s.a)((function(){var e=z(),t=e.swapStore,n=e.userStore,r=t.loadHistory,o=t.loading,a=t.historyMap;return Object(i.useEffect)((function(){r(n.user.id)}),[r,n.user]),o?Object(U.jsx)(Q,{content:"Loading history"}):Object(U.jsx)(U.Fragment,{children:Object(U.jsx)(le.a,{centered:!0,columns:1,children:Object(U.jsx)(le.a.Column,{width:16,children:0===Array.from(a.values()).length?Object(U.jsx)("h3",{children:"No swaps made "}):Object(U.jsx)(ye,{})})})})})),Ce=n(420),Me=Object(s.a)((function(e){var t=e.setEditMode,n=z().profileStore,r=n.profile,o=n.updateProfile,a=Object(i.useState)(""),c=Object(V.a)(a,2),s=c[0],u=c[1],l=["Antrim","Armagh","Carlow","Cavan","Clare","Cork","Derry","Donegal","Down","Dublin","Fermanagh","Galway","Kerry","Kildare","Kilkenny","Laois","Leitrim","Limerick","Longford","Louth","Mayo","Meath","Monaghan","Offaly","Roscommon","Sligo","Tipperary","Tyrone","Waterford","Westmeath","Wexford","Wicklow"],d=be.a.map(l,(function(e,t){return{key:l[t],text:e,value:l[t]}}));function j(e,t){u(t.value)}return Object(U.jsx)(U.Fragment,{children:Object(U.jsx)(Y.c,{initialValues:{bio:r.bio,county:r.county,displayName:r.displayName,userName:r.userName},onSubmit:function(e){!function(e){e.county=s,o(e).then((function(){t(!1)}))}(e)},validationSchema:$.b({bio:$.c().required(),county:$.c().required()}),children:function(e){var t=e.isSubmitting,n=e.isValid;e.dirty;return Object(U.jsxs)(Y.b,{className:"ui form",children:[Object(U.jsx)(ne,{placeholder:"Display Name",name:"bio"}),Object(U.jsx)(b.a,{name:"county",placeholder:"County",search:!0,selection:!0,options:d,onChange:j,defaultValue:r.county}),Object(U.jsx)(K.a,{positive:!0,type:"submit",loading:t,content:"Update profile",floated:"right",disabled:!n})]})}})})})),Ie=Object(s.a)((function(){var e=z().profileStore,t=e.profile,n=e.isCurrentUser,r=Object(i.useState)(!1),o=Object(V.a)(r,2),a=o[0],c=o[1];return Object(U.jsx)(Ce.a.Pane,{children:Object(U.jsxs)(le.a,{children:[Object(U.jsx)(le.a.Column,{width:"16",children:n&&Object(U.jsx)(K.a,{floated:"right",basic:!0,content:a?"Cancel":"Edit Profile",onClick:function(){return c(!a)}})}),Object(U.jsx)(le.a.Column,{width:"16",children:a?Object(U.jsx)(Me,{setEditMode:c}):Object(U.jsx)("span",{style:{whiteSpace:"pre-wrap"},children:null===t||void 0===t?void 0:t.bio})})]})})})),Le=Object(s.a)((function(){var e=z(),t=e.bookStore,n=e.profileStore,r=t.booksOwnedMap,o=t.deleteBook,a=t.loading,c=n.isCurrentUser,s=Object(i.useState)(""),l=Object(V.a)(s,2),d=l[0],b=l[1];return Object(U.jsx)(Ce.a.Pane,{children:Object(U.jsx)(le.a.Column,{width:16,children:Object(U.jsx)(ae.a.Group,{itemsPerRow:4,children:Array.from(r.values()).map((function(e){return Object(U.jsxs)(ae.a,{fluid:!0,children:[Object(U.jsx)(j.a,{src:e.image,style:{height:"275px"}}),Object(U.jsx)(K.a.Group,{fluid:!0,widths:2,children:c?Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)(K.a,{basic:!0,color:"blue",content:"Details",as:u.a,to:"/edit/".concat(e.id)}),Object(U.jsx)(K.a,{basic:!0,color:"red",icon:"trash",loading:d===e.id&&a,onClick:function(t){return function(e,t){b(e.currentTarget.name),o(t)}(t,e.id)}})]}):Object(U.jsx)(K.a,{basic:!0,color:"blue",content:"Details",as:u.a,to:"/books/".concat(e.id)})})]},e.id)}))})})})})),Ae=n(241);function Be(e){var t=e.setFiles,n={border:"dashed 3px #000000",borderColor:"#000000",borderRadius:"5px",paddingTop:"30px",textAlign:"center",height:200},r=Object(i.useCallback)((function(e){t(e.map((function(e){return Object.assign(e,{preview:URL.createObjectURL(e)})})))}),[t]),o=Object(Ae.a)({onDrop:r}),a=o.getRootProps,c=o.getInputProps,s=o.isDragActive;return Object(U.jsxs)("div",Object(P.a)(Object(P.a)({},a()),{},{style:s?Object(P.a)(Object(P.a)({},n),{borderColor:"#49a621"}):n,children:[Object(U.jsx)("input",Object(P.a)({},c())),Object(U.jsx)(d.a,{name:"upload",size:"huge"}),Object(U.jsx)(_.a,{as:"h3",content:"Drag and drop image"})]}))}var qe=Object(s.a)((function(e){var t=e.loading,n=e.uploadPhoto,r=Object(i.useState)([]),o=Object(V.a)(r,2),a=o[0],c=o[1];return Object(U.jsxs)(le.a,{children:[Object(U.jsxs)(le.a.Column,{width:4,children:[Object(U.jsx)(_.a,{color:"teal",content:"Add photo"}),Object(U.jsx)(Be,{setFiles:c})]}),Object(U.jsx)(le.a.Column,{width:1}),Object(U.jsxs)(le.a.Column,{width:4,children:[Object(U.jsx)(_.a,{color:"teal",content:"Preview & Uplaod"}),a&&a.length>0&&Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)(j.a,{src:a[0].preview}),Object(U.jsx)(K.a,{loading:t,onClick:function(){n(a[0])},positive:!0,icon:"check"}),Object(U.jsx)(K.a,{disabled:t,onClick:function(){return c([])},icon:"close"})]})]})]})})),Pe=Object(s.a)((function(){var e,t=z().profileStore,n=t.profile,r=t.isCurrentUser,o=t.uploadPhoto,a=t.isUploading,c=t.isMainLoading,s=t.setMain,u=t.deletePhoto,l=Object(i.useState)(!1),d=Object(V.a)(l,2),b=d[0],p=d[1],h=Object(i.useState)(""),f=Object(V.a)(h,2),O=f[0],x=f[1];return Object(U.jsx)(Ce.a.Pane,{children:Object(U.jsxs)(le.a,{children:[Object(U.jsxs)(le.a.Column,{width:16,children:[Object(U.jsx)(_.a,{floated:"left",content:"Profile photos",icon:"image"}),r&&Object(U.jsx)(K.a,{floated:"right",basic:!0,content:b?"Cancel":"Add photo",onClick:function(){return p(!b)}})]}),Object(U.jsx)(le.a.Column,{width:16,children:b?Object(U.jsx)(qe,{uploadPhoto:function(e){o(e).then((function(){return p(!1)}))},loading:a}):Object(U.jsx)(ae.a.Group,{itemsPerRow:5,children:null===n||void 0===n||null===(e=n.photos)||void 0===e?void 0:e.map((function(e){return Object(U.jsxs)(ae.a,{children:[Object(U.jsx)(j.a,{src:e.url}),r&&Object(U.jsxs)(K.a.Group,{fluid:!0,widths:2,children:[Object(U.jsx)(K.a,{basic:!0,color:"green",content:"Main",name:"unique"+e.id,disabled:e.isMain,onClick:function(t){return function(e,t){x(e.currentTarget.name),s(t)}(t,e)},loading:O==="unique"+e.id&&c}),Object(U.jsx)(K.a,{basic:!0,color:"red",icon:"trash",name:e.id,loading:O===e.id&&c,onClick:function(t){return function(e,t){x(e.currentTarget.name),u(t)}(t,e)},disabled:e.isMain})]})]},e.id)}))})})]})})})),Re=Object(s.a)((function(){var e=[{menuItem:"Details",render:function(){return Object(U.jsx)(Ie,{})}},{menuItem:"Books",render:function(){return Object(U.jsx)(Le,{})}},{menuItem:"Photos",render:function(){return Object(U.jsx)(Pe,{})}}];return Object(U.jsx)(U.Fragment,{children:Object(U.jsx)(Ce.a,{menu:{fluid:!0,vertical:!0},menuPosition:"right",panes:e})})})),Ne=Object(s.a)((function(){var e=z(),t=e.bookStore,n=e.swapStore,r=e.profileStore,o=t.booksOwnedMap,a=n.historyMap,i=r.profile;return Object(U.jsx)(U.Fragment,{children:Object(U.jsx)(H.a,{children:Object(U.jsxs)(le.a,{columns:2,divided:!0,children:[Object(U.jsx)(le.a.Column,{width:12,children:Object(U.jsx)(he.a.Group,{children:Object(U.jsxs)(he.a,{children:[(null===i||void 0===i?void 0:i.image)?Object(U.jsx)(he.a.Image,{verticalAlign:"middle",avatar:!0,size:"small",src:null===i||void 0===i?void 0:i.image}):Object(U.jsx)(d.a,{name:"user",verticleAlign:"middle",size:"huge"}),Object(U.jsxs)(he.a.Content,{verticalAlign:"middle",children:[Object(U.jsx)(_.a,{as:"h2",content:null===i||void 0===i?void 0:i.userName}),Object(U.jsx)(le.a.Column,{width:1}),Object(U.jsx)(_.a,{as:"h4",content:null===i||void 0===i?void 0:i.county})]})]})})}),Object(U.jsx)(le.a.Column,{width:4,children:Object(U.jsxs)(he.a,{style:{marginTop:"45px",marginLeft:"50px"},children:[Object(U.jsx)(he.a.Content,{verticalAlign:"middle",children:Object(U.jsxs)(_.a,{as:"h3",children:[Array.from(o.values()).length," books owned "]})}),Object(U.jsx)(he.a,{style:{marginTop:"10px"},children:Object(U.jsx)(he.a.Content,{verticalAlign:"middle",children:Object(U.jsxs)(_.a,{as:"h3",children:[a.values.length," swaps made "]})})})]})})]})})})})),De=Object(s.a)((function(){var e=Object(a.i)().username,t=z(),n=t.profileStore,r=t.bookStore,o=t.userStore,c=r.loadOwnedBooks,s=r.loading,u=n.loadingProfile,l=n.loadProfile;return Object(i.useEffect)((function(){l(e),c(o.user.id)}),[l,e,c,o.user]),u||s?Object(U.jsx)(Q,{content:"Loading profile"}):Object(U.jsx)(U.Fragment,{children:Object(U.jsx)(le.a,{children:Object(U.jsxs)(le.a.Column,{width:16,children:[Object(U.jsx)(Ne,{}),Object(U.jsx)(Re,{})]})})})})),Ee=n(413),Te=n(410),Fe=Object(s.a)((function(e){var t=e.swapId,n=z().messageStore;return Object(i.useEffect)((function(){return t&&n.createHubConnection(t),function(){n.removeMessages()}}),[n,t]),Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)(H.a,{textAlign:"center",attached:"top",color:"teal",style:{border:"none"},children:Object(U.jsx)(_.a,{children:"Message with member"})}),Object(U.jsxs)(H.a,{attached:!0,clearing:!0,children:[Object(U.jsx)(Ee.a.Group,{children:n.messages.map((function(e){return Object(U.jsxs)(Ee.a,{children:[e.image?Object(U.jsx)(Ee.a.Avatar,{src:e.image}):Object(U.jsx)(d.a,{name:"user"}),Object(U.jsxs)(Ee.a.Content,{children:[Object(U.jsx)(Ee.a.Author,{as:u.a,to:"/profiles/".concat(e.userName),children:e.displayName}),Object(U.jsx)(Ee.a.Metadata,{children:Object(U.jsxs)("div",{children:[Object(Te.a)(e.createdAt)," ago"]})}),Object(U.jsx)(Ee.a.Text,{style:{whiteSpace:"pre-wrap"},children:e.text})]})]},e.id)}))}),Object(U.jsx)(Y.c,{onSubmit:function(e,t){var r=t.resetForm;return n.addMessage(e).then((function(){return r()}))},initialValues:{text:""},validationSchema:$.b({text:$.c().required()}),children:function(e){var t=e.isSubmitting,n=e.isValid,r=e.handleSubmit;return Object(U.jsx)(ee.a,{className:"ui form",children:Object(U.jsx)(Y.a,{name:"text",children:function(e){return Object(U.jsxs)("div",{style:{position:"relative"},children:[Object(U.jsx)(Z.a,{active:t}),Object(U.jsx)("textarea",Object(P.a)(Object(P.a)({placeholder:"Enter your comment (Enter to submit, SHIFT + enter for new line)",rows:2},e.field),{},{onKeyPress:function(e){"Enter"===e.key&&e.shiftKey||"Enter"!==e.key||e.shiftKey||(e.preventDefault(),n&&r())}}))]})}})})}})]})]})})),ze=Object(s.a)((function(){var e=z().swapStore,t=e.selectedSwap,n=e.loadSwap,r=e.loadingInitial,o=e.clearSelectedSwap,c=Object(a.i)().swapId;return Object(i.useEffect)((function(){return c&&n(c),function(){return o()}}),[c,n,o]),r||!t?Object(U.jsx)(Q,{}):Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)("h1",{children:"Chat about swap"}),Object(U.jsx)(Fe,{swapId:c})]})})),Ue=n(239),Ge=["component"],He=Object(s.a)((function(e){var t=e.component,n=Object(Ue.a)(e,Ge),r=z().userStore.checkLogin;return Object(U.jsx)(a.b,Object(P.a)(Object(P.a)({},n),{},{render:function(e){return r?Object(U.jsx)(t,Object(P.a)({},e)):Object(U.jsx)(a.a,{to:"/"})}}))}));var _e=Object(s.a)((function(){var e=Object(a.h)(),t=z(),n=t.commonStore,r=t.userStore;return Object(i.useEffect)((function(){n.token?r.getUser().finally((function(){return n.setApplicationLoaded(!0)})):n.setApplicationLoaded(!0)}),[n,r]),n.applicationLoaded?Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)(ce.a,{position:"bottom-right",hideProgressBar:!0}),Object(U.jsx)(a.b,{exact:!0,path:"/",component:W}),Object(U.jsx)(a.b,{exact:!0,path:"/login",component:de}),Object(U.jsx)(a.b,{exact:!0,path:"/register",component:pe}),Object(U.jsx)(a.b,{path:["/books","/books/:id","/edit/:id","/edit","/createBook","/server-error","/not-found","/swaps","/requestor/:id","/history","/profile/:username","/history/:swapId"],render:function(){return Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)(G,{}),Object(U.jsx)(c.a,{style:{marginTop:"10em"},children:Object(U.jsxs)(a.d,{children:[Object(U.jsx)(He,{exact:!0,path:"/books",component:me}),Object(U.jsx)(He,{path:"/books/:id",component:ie}),Object(U.jsx)(He,{path:["/edit/:id","/edit"],component:oe},e.key),Object(U.jsx)(He,{path:"/createBook",component:ue}),Object(U.jsx)(He,{path:"/profile/:username",component:De}),Object(U.jsx)(He,{path:"/requestor/:id",component:ke}),Object(U.jsx)(He,{path:"/swaps",component:we}),Object(U.jsx)(He,{exact:!0,path:"/history",component:Se}),Object(U.jsx)(He,{path:"/history/:swapId",component:ze}),Object(U.jsx)(a.b,{component:se})]})})]})}})]}):Object(U.jsx)(Q,{content:"loading application"})})),Ke=(n(390),n(41)),We=Object(Ke.a)();o.a.render(Object(U.jsx)(F.Provider,{value:T,children:Object(U.jsx)(a.c,{history:We,children:Object(U.jsx)(_e,{})})}),document.getElementById("root"))}},[[391,1,2]]]);
//# sourceMappingURL=main.710c4efb.chunk.js.map